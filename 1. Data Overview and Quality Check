# Step 1: Data Overview.
# Step 2: SQL-based data quality rules and orchestrated execution using Python to support continuous monitoring.

Part 2ï¼šè¿›å…¥ SQL å‰ï¼Œå¿…é¡»åšçš„ Data Quality & Data Cleansing Checks

A. Structural & Schema Checksï¼ˆç»“æ„å®Œæ•´æ€§ï¼‰

æ˜¯å¦å­˜åœ¨ NULL / missingï¼š
instance, agg_code, periode, volume

agg_code æ˜¯å¦åªåŒ…å«é¢„æœŸå€¼ï¼š
{f, h, d, m, y}

periode æ˜¯å¦å¯è¢«ä¸€è‡´è§£æä¸º timestamp / date

ç›®çš„ï¼šç¡®ä¿æ•°æ®èƒ½è¿›å…¥ monitoring pipelineï¼Œè€Œä¸æ˜¯ä¿®ä¸šåŠ¡é€»è¾‘ã€‚

B. Grain Integrity Checksï¼ˆç²’åº¦ä¸€è‡´æ€§ï¼‰æ˜¯å¦å­˜åœ¨â€œé‡å¤äº‹å®â€ï¼Ÿ

(instance, direction, agg_code, periode) æ˜¯å¦å”¯ä¸€

æœ‰é‡å¤ â†’ æ ‡è®°ä¸º data quality issue, ä¸åœ¨ Python é‡Œâ€œæ‚„æ‚„ dropâ€
è¿™æ˜¯å…¬å¸æœ€çœ‹é‡çš„ä¸€ç±» checkã€‚

C. Temporal Coverage Checksï¼ˆæ—¶é—´è¦†ç›–ï¼‰ä¸å¯¹é½æ—¶é—´è½´ï¼Œåªåšäº‹å®è¯†åˆ«ï¼š

æ¯ä¸ª instanceï¼š
æœ€æ—© periode, æœ€æ™š periode

æ˜¯å¦å­˜åœ¨å¼‚å¸¸é•¿ gapï¼ˆä¾‹å¦‚ > N å°æ—¶ï¼‰

ç”¨äºï¼š
å†·å¯åŠ¨è¯†åˆ«, æ•°æ®ç¼ºå¤±æ ‡è®°ï¼ˆä¸æ˜¯å¼‚å¸¸ï¼‰

D. Value Sanity Checksï¼ˆæ•°å€¼åˆç†æ€§ï¼‰ä¸åšç»Ÿè®¡å»ºæ¨¡ï¼Œåªåšç‰©ç†ä¸å¯èƒ½æ£€æŸ¥ï¼š

volume < 0 âŒ
volume = 0 æ˜¯å¦è¿ç»­å¼‚å¸¸é•¿æ—¶é—´
vitesse <= 0 æˆ–æç«¯å€¼ï¼ˆå¦‚ > 60 km/hï¼‰
ğŸ‘‰ è¿™æ˜¯ data qualityï¼Œä¸æ˜¯ anomaly detectionã€‚

E. Cross-Dataset Alignment Checksï¼ˆä¸æ–½å·¥æ•°æ®çš„å¯å¯¹é½æ€§ï¼‰

åœ¨ SQL è‡³å°‘è¦éªŒè¯ï¼š

construction dataset æ˜¯å¦åŒ…å«ï¼š
å¯è§£ææ—¶é—´èŒƒå›´
å¯å®šä½åˆ° street segment
cycling sensors æ˜¯å¦èƒ½ï¼š
spatially join åˆ° street / buffer
åªéªŒè¯â€œèƒ½ä¸èƒ½ joinâ€ï¼Œä¸è§£é‡Šç»“æœã€‚

F. Explicit Non-Cleansing Decisionsï¼ˆéå¸¸åŠ åˆ†ï¼‰

åº”è¯¥æ˜ç¡®å†™å‡ºåˆ»æ„ä¸åšçš„äº‹ï¼š

ä¸æ’å€¼å¡«è¡¥ç¼ºå¤±æ—¶é—´
ä¸å¼ºåˆ¶å¯¹é½ instance æ—¶é—´è½´
ä¸åˆ é™¤ä½æµé‡è®°å½•
ğŸ“Œ è¿™ä½“ç°çš„æ˜¯ design awarenessï¼Œä¸æ˜¯å·æ‡’ã€‚
